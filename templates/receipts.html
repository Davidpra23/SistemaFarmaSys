
{% extends "base.html" %}
{% block header_title %}Recibos{% endblock %}
{% block content %}
<div class="content-section">
  <div class="section-header">
    <h2><i class="fas fa-receipt"></i> Recibos Recientes</h2>
  </div>

  {% if receipts %}
  <div style="overflow-x: auto; border-radius: 0.75rem; border: 1px solid var(--gray-200); background: white;">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="background: var(--gray-50); border-bottom: 1px solid var(--gray-200);">
          <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Número de Recibo</th>
          <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Fecha/Hora</th>
          <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Cliente</th>
          <th style="padding: 1rem; text-align: center; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Artículos</th>
          <th style="padding: 1rem; text-align: left; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Método Pago</th>
          <th style="padding: 1rem; text-align: right; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Total</th>
          <th style="padding: 1rem; text-align: center; font-weight: 600; color: var(--gray-700); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for r in receipts %}
        <tr style="border-bottom: 1px solid var(--gray-200); transition: background 0.2s;">
          <td style="padding: 1rem; color: var(--gray-800);">
            <div style="display: flex; align-items: center; gap: 0.5rem;">
              <i class="fas fa-barcode" style="color: var(--primary);"></i>
              <code style="background: var(--gray-50); padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem;">{{ r['id'][:8] }}</code>
            </div>
          </td>
          <td style="padding: 1rem; color: var(--gray-600);">
            <i class="fas fa-calendar-alt" style="margin-right: 0.5rem; color: var(--gray-500);"></i>
            {{ r['datetime'].replace('T', ' ')[:19] }}
          </td>
          <td style="padding: 1rem; color: var(--gray-600);">
            {% if r['customer'] %}
              <i class="fas fa-user" style="margin-right: 0.5rem; color: var(--gray-500);"></i>
              {{ r['customer'] }}
            {% else %}
              <span style="color: var(--gray-400);">Anónimo</span>
            {% endif %}
          </td>
          <td style="padding: 1rem; text-align: center; color: var(--gray-800);">
            <span style="background: var(--primary-light); color: white; padding: 0.25rem 0.75rem; border-radius: 2rem; font-weight: 600; font-size: 0.875rem;">
              {{ r['items']|length }}
            </span>
          </td>
          <td style="padding: 1rem; color: var(--gray-600);">
            <span style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.375rem 0.75rem; background: var(--gray-100); border-radius: 0.5rem; font-size: 0.875rem;">
              {% if r['payment_method'] == 'cash' %}
                <i class="fas fa-money-bill-wave" style="color: #10b981;"></i> Efectivo
              {% elif r['payment_method'] == 'card' %}
                <i class="fas fa-credit-card" style="color: #3b82f6;"></i> Tarjeta
              {% else %}
                {{ r['payment_method']|upper }}
              {% endif %}
            </span>
          </td>
          <td style="padding: 1rem; color: var(--gray-800); text-align: right;">
            <span style="font-weight: 700; color: var(--primary); font-size: 1.125rem;">
              $ {{ '%.2f'|format(r['total']) }}
            </span>
            <div style="font-size: 0.75rem; color: var(--gray-500);">
              Sub: $ {{ '%.2f'|format(r.get('subtotal', 0)) }}
            </div>
          </td>
          <td style="padding: 1rem; text-align: center;">
            <div style="display: flex; justify-content: center; gap: 0.5rem;">
              <a class="btn" href="{{ url_for('view_receipt', rid=r['id']) }}" 
                 style="padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 0.5rem; cursor: pointer; display: inline-flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; text-decoration: none; transition: all 0.2s;">
                <i class="fas fa-eye"></i> Ver
              </a>
              <a class="btn" href="{{ url_for('view_receipt', rid=r['id']) }}" target="_blank"
                 style="padding: 0.5rem 1rem; background: var(--secondary); color: white; border: none; border-radius: 0.5rem; cursor: pointer; display: inline-flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; text-decoration: none; transition: all 0.2s;">
                <i class="fas fa-print"></i> Imprimir
              </a>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div style="text-align: center; padding: 3rem; background: white; border-radius: 1rem; box-shadow: var(--shadow);">
    <i class="fas fa-inbox" style="font-size: 3rem; color: var(--gray-300); margin-bottom: 1rem;"></i>
    <h3 style="color: var(--gray-600); margin-bottom: 0.5rem;">No hay recibos aún</h3>
    <p style="color: var(--gray-500);">Los recibos aparecerán aquí cuando realices tu primera venta.</p>
    <a href="{{ url_for('sales') }}" class="btn btn-primary" style="margin-top: 1rem; display: inline-flex; align-items: center; gap: 0.5rem;">
      <i class="fas fa-shopping-cart"></i> Ir a Ventas
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}
